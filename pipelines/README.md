# Pipelines 


## 1) main_pipeline.sh
Pipeline used to assemble GENSOR Units, obtain presence of feedback and connectivity values. Composed of 11 scripts:

&nbsp;a) gu_assembly_v4.pl - Consults RegulonDB datasets (~/datasets/input_files/) to obtain, for each TF, its known effectors, active/inactive conformations, regulated genes and effect of regulatory interactions. Connects to Pathway Tools through perlcyc api, for each target gene obtains: gene products, catalysed reactions, reactants and products of reactions, complexes of which gene products are part of. Produces a directory for each TF with five tab-delimited files that contain all the retrieved information (~/datasets/GUs_raw_files/).

&nbsp;b) secondary_reaction_comparison.pl - Calls add_secondary_reactions_v4.pl (c) iteratively allowing 0 to 25 intermediate reactions. Produces a file (~/datasets/results/SRs_comparison.txt) with the comparison of secondary reactions added to the GENSOR Unit using X allowed intermediate reactions (Figure S2). 

&nbsp;c) add_secondary_reactions_v4.pl - Finds pairs of reactions in a GENSOR Unit that are present in the same metabolic pathway and are thus connected through a series of intermediate reactions (Figure S1). The number of allowed intermediate reactions is introduced as an argument. Intermediate reactions are added to gu_assembly_v4.pl (a) output in a new directory (~/datasets/GUs_secondary_reactions/). It is run with a maximum of 9 allowed intermediate reactions because, as shown by (b), more intermediate steps make no difference.

&nbsp;d) enzyme_count_v2.pl - Obtains number of enzymes present in each GENSOR Unit by identifying proteins and checking if they are associated to a catalysis reaction. The total count is used to calculate connectivity (Figure 2, see formula in text). Complexes are counted as individual enzymes to avoid bias in GENSOR Units with big complexes. 

&nbsp;e) get_catalysis_reactions.pl - Obtains the total catalysis reactions present in each GENSOR Unit. They are used to identify GENSOR Units with a metabolic part present in the form of catalysed reactions' reactants and products. GENSOR Units that do not include metabolites or reactions are not relevant in feedback/connectivity measurements since these properties rely on the relationship between the regulated genes and metabolism; they were excluded from figure 2. 

&nbsp;f) get_short_paths_v3.pl - Obtains all the possible metabolic fluxes in a GENSOR Unit by finding pairs of reactions that share a metabolite. A minimum length for the metabolic flux is introduced as argument, a flux of length "0" is composed of only 1 reaction, a flux of length "1" is composed of two connected reactions and so forth. In this instance of the pipeline the script is used with flux length "0" to obtain all possible fluxes.

&nbsp;g) find_components.pl - A component is an independent part of a network, a group of nodes that are connected among them but not connected to other nodes in the network. This script identifies groups of reactions in a GENSOR Unit that are connected among them (because they share reactants/products) but are not connected to any other reaction in the GENSOR Unit. This number is used to calculate connectivity (Figure 2, see formula in text).

&nbsp;h) get_short_paths_v3.pl - Same as (f) but only allowing fluxes of length 1 to identify all the connected enzymes in the GENSOR Unit (i.e. those whose reactions create a component with reactions catalysed by other enzymes). The connected enzymes are used to calculate connectivity (Figure 2, see formula in text).

&nbsp;i) get_connectivity_v1.pl - Calculates connectivity using (h), (g) and (d) outputs using formula shown in the paper.

&nbsp;j) find_feedback.pl - Identifies the presence of the effector in a metabolic flux present in the GENSOR Unit (output of (f)), if it is present, it means it is used or produced by the GENSOR Unit and therefore feedback exists. Two-component systems whose effector is annotated as "phosphate" were omitted from the analysis.

&nbsp;k) get_summary.pl - Creates a tab-delimited file with all the quantitative information generated by the pipeline for easier visualisation.

## 2) pipeline_connectivity_pathways.sh
Pipeline used to calculate connectivity for 362 groups of genes involved in base pathways reported in Ecocyc (https://ecocyc.org/overviewsWeb/celOv.shtml). Uses scripts b-k, the only difference being the data retrieval since the groups are pathways and not regulons. Different script is:

&nbsp;l) gu_assembly_groups.pl - Modification from (a), takes as input any group of genes instead of retrieving genes regulated by a TF. Obtains their gene products, catalyzed reactions and protein complexes in which the gene products participate.


## 3) pipeline_connectivity_with_effect.sh
Pipeline used to calculate connectivity of GENSOR Units considering TF-gene regulatory effect (activation/repression) (Figure 2b). In all scripts genes under dual regulation are considered in both activation and repression.

&nbsp;m) get_short_paths_v5.pl - Same as (f) and (h), but only finds metabolic fluxes of reactions under the same regulatory effect. It is run using raw GUs for identifying total components to avoid components that only include secondary reactions. It is run four times to include all combinations: calculations for components (f) and connectivity (h), for activated and repressed reactions.

&nbsp;n) enzyme_count_effect.pl - Same as (d), but considering separately activated and repressed enzymes. 

&nbsp;o) get_connectivity_weffect.pl - Finds number of connected enzymes in each GENSOR Unit when only activated or repressed enzymes are considered. Activation/repression is specified as an argument.

&nbsp;p) find_components.pl - Exact same as (g), run twice for activated and repressed metabolic fluxes.

&nbsp;q) connectivity_calculator_weffect.pl - Same as (i), but considering separately activated and repressed enzymes.

	
###### Questions and comments please contact Daniela Ledezma @ dledezma@lcg.unam.mx 
